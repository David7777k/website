# Changelog

–í—Å—ñ –≤–∞–∂–ª–∏–≤—ñ –∑–º—ñ–Ω–∏ –≤ –ø—Ä–æ–µ–∫—Ç—ñ PANDA Lounge –¥–æ–∫—É–º–µ–Ω—Ç—É—é—Ç—å—Å—è —Ç—É—Ç.

## [v2.1.0] - 2025-01-07

### üéØ –ö—Ä–∏—Ç–∏—á–Ω—ñ —Ñ—ñ–∫—Å–∏

#### üîß –ù–∞–≤—ñ–≥–∞—Ü—ñ—è (–í–ò–ü–†–ê–í–õ–ï–ù–û)
- ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—Å—ñ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ —è–∫–æ—Ä—ñ —Ç–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ –æ–∫—Ä–µ–º—É —Å—Ç–æ—Ä—ñ–Ω–∫—É `/wheel` –¥–ª—è –∫–æ–ª–µ—Å–∞ —Ñ–æ—Ä—Ç—É–Ω–∏
- ‚úÖ –ó–∞–º—ñ–Ω–µ–Ω–æ –≤—Å—ñ `href="#wheel"` –Ω–∞ `/wheel`
- ‚úÖ –ó–∞–º—ñ–Ω–µ–Ω–æ –≤—Å—ñ `href="#"` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è (Instagram, Telegram)
- ‚úÖ –î–æ–¥–∞–Ω–æ loading states (Suspense) –¥–ª—è –≤—Å—ñ—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ä–æ—É—Ç—ñ–≤
- ‚úÖ ErrorBoundary –≤–∂–µ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫

#### üé° –ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω–∏ - –ú–∞—à–∏–Ω–∞ —Å—Ç–∞–Ω—ñ–≤ (FSM)
- ‚úÖ **API Endpoints:**
  - `GET /api/wheel/status` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  - `POST /api/wheel/spin` - –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –∫–æ–ª–µ—Å–∞ –∑ –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é
- ‚úÖ **FSM States:** LOADING ‚Üí READY ‚Üí SPINNING ‚Üí RESULT ‚Üí COOLDOWN ‚Üí ERROR
- ‚úÖ **–°–µ—Ä–≤–µ—Ä–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:**
  - –ö—É–ª–¥–∞—É–Ω 7 –¥–Ω—ñ–≤ –º—ñ–∂ —Å–ø—ñ–Ω–∞–º–∏
  - –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (NextAuth)
  - –ê–Ω—Ç—ñ-–∞–±—É–∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è (IP, User Agent)
- ‚úÖ **–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∞ –≤–∏–¥–∞—á–∞ –ø—Ä–∏–∑—ñ–≤:**
  - –ê—Ç–æ–º–∞—Ä–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è: WheelSpin + Coupon + AuditLog
  - –ü—Ä–∏–∑–∏ –¥—ñ—é—Ç—å 7 –¥–Ω—ñ–≤ –ø—ñ—Å–ª—è –≤–∏–≥—Ä–∞—à—É
  - –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
- ‚úÖ **UI –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:**
  - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è WheelModal –∑ API
  - –ü—Ä–∞–≤–∏–ª—å–Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω—ñ–≤ (READY, COOLDOWN, SPINNING)
  - –¢–∞–π–º–µ—Ä –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ø—ñ–Ω—É
  - Toast-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞–º—ñ—Å—Ç—å –ø–æ–ø–∞–ø—ñ–≤

#### üîê NextAuth —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—è
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é NextAuth
- ‚úÖ JWT strategy –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ callbacks
- ‚úÖ –ó–∞—Ö–∏—Å—Ç API endpoints —á–µ—Ä–µ–∑ getServerSession
- ‚úÖ Middleware –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É /staff/* —Ç–∞ /profile/*

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

#### –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ö–µ–º–∏
- **WheelSpin:** –¥–æ–¥–∞–Ω–æ `prize_id`, `prize_name`, `state`, —ñ–Ω–¥–µ–∫—Å–∏
- **WheelPrize:** –¥–æ–¥–∞–Ω–æ `icon`, `max_per_period`, `current_count`, `updated_at`
- **AuditLog (NEW):** —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –¥—ñ–π
  - `user_id`, `action`, `entity_type`, `entity_id`, `details` (JSON)
  - –Ü–Ω–¥–µ–∫—Å–∏ –ø–æ `user_id`, `action`, `created_at`

#### –ú—ñ–≥—Ä–∞—Ü—ñ—ó
```bash
npx prisma migrate dev --name add_wheel_fsm_and_audit
```

### üì¶ –ù–æ–≤—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

- `/app/app/wheel/page.tsx` - –æ–∫—Ä–µ–º–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∫–æ–ª–µ—Å–∞
- `/app/app/wheel/loading.tsx` - loading state
- `/app/app/api/wheel/status/route.ts` - API —Å—Ç–∞—Ç—É—Å—É
- `/app/app/api/wheel/spin/route.ts` - API —Å–ø—ñ–Ω—É (–æ–Ω–æ–≤–ª–µ–Ω–æ)
- Loading states –¥–ª—è: profile, events, menu, music

### üîí –ë–µ–∑–ø–µ–∫–∞

- ‚úÖ –í—Å—ñ –∫—Ä–∏—Ç–∏—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—ñ–≤ —á–µ—Ä–µ–∑ NextAuth
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è —Å–ø—Ä–æ–± –æ–±—Ö–æ–¥—É –∫—É–ª–¥–∞—É–Ω—É
- ‚úÖ –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ race conditions (—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó)
- ‚úÖ Audit log –¥–ª—è –≤—Å—ñ—Ö –≤–∞–∂–ª–∏–≤–∏—Ö –¥—ñ–π

### üìù –ü—Ä–∞–≤–∏–ª–∞ –∫–æ–ª–µ—Å–∞ —Ñ–æ—Ä—Ç—É–Ω–∏

- üé° –°–ø—ñ–Ω –¥–æ—Å—Ç—É–ø–Ω–∏–π —Ä–∞–∑ –Ω–∞ 7 –¥–Ω—ñ–≤
- üéÅ –ü—Ä–∏–∑–∏ –¥—ñ—é—Ç—å 7 –¥–Ω—ñ–≤
- üíé –í–∏–≥—Ä–∞—à—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —è–∫ –∫—É–ø–æ–Ω–∏ –≤ –ë–î
- üìä –í—ñ—Ä–æ–≥—ñ–¥–Ω–æ—Å—Ç—ñ –ø—Ä–∏–∑—ñ–≤ –Ω–∞–ª–∞—à—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –ë–î
- üîê –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∞–±—É–∑—É —á–µ—Ä–µ–∑ –∫—É–ª–¥–∞—É–Ω

### üîÑ –ó–º—ñ–Ω–∏ –≤ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó

#### –î–æ v2.1:
```tsx
href: '#wheel'  // ‚ùå –ù–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ
```

#### –ü—ñ—Å–ª—è v2.1:
```tsx
href: '/wheel'  // ‚úÖ –ü—Ä–∞—Ü—é—î
```

### üìö –û–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- `.env.example` - –¥–æ–¥–∞–Ω–æ QR_SECRET, QR_TTL_MINUTES
- –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ —â–æ–¥–æ PostgreSQL –¥–ª—è production
- –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑ –º—ñ–≥—Ä–∞—Ü—ñ–π

---

## [v2.0.0] - 2024-10-01

### –û—Å–Ω–æ–≤–Ω–∏–π —Ä–µ–ª—ñ–∑
- Next.js 15.5 + TypeScript 5.3
- Prisma 6.16 ORM
- NextAuth –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü—ñ—è
- QR —Å–∏—Å—Ç–µ–º–∞
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞
- –ú—É–∑–∏—á–Ω–∏–π –¥–∂—É–∫–±–æ–∫—Å
- –°–∏—Å—Ç–µ–º–∞ —á–∞–π–æ–≤–∏—Ö
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

---

## Roadmap v2.2 (–ø–ª–∞–Ω—É—î—Ç—å—Å—è)

### –§–ê–ó–ê 4: PostgreSQL Production
- [ ] –ú—ñ–≥—Ä–∞—Ü—ñ—è –∑ SQLite –Ω–∞ PostgreSQL –¥–ª—è production
- [ ] –û–Ω–æ–≤–ª–µ–Ω–Ω—è schema.prisma
- [ ] –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–µ–ø–ª–æ—é –∑ PostgreSQL

### –§–ê–ó–ê 5: E2E —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- [ ] Playwright setup
- [ ] –ë–∞–∑–æ–≤—ñ —Ç–µ—Å—Ç–∏: auth, wheel, navigation
- [ ] CI/CD integration

### –§–ê–ó–ê 6: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è)
- [ ] CRUD –¥–ª—è events, wheel prizes
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (recharts)
- [ ] –ê—É–¥–∏—Ç-–ª–æ–≥ UI
- [ ] –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏

### –Ü–Ω—à—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è
- [ ] Real-time notifications (WebSocket)
- [ ] Rate limiting –Ω–∞ API
- [ ] 2FA –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤
- [ ] PWA manifest —ñ offline support

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ v2.1 - Production Ready  
**–ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–µ–ª—ñ–∑:** v2.2 (PostgreSQL + E2E —Ç–µ—Å—Ç–∏)
